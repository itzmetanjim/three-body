<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Three-Body Problem Plot</title>

    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="libraries/p5.min.js"></script>
    <script src="libraries/p5.sound.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/p5.capture@1.6.0/dist/p5.capture.umd.min.js"></script>
  </head>

  <body>
  <div align="center" style="width:50%;">
    <!--<h2>Three Body Problem Plot</h2>
    <h3>By Tanjim Kamal</h3>-->
  </div>
    
    <div  style="position:absolute; left:50%; top:0%;">

    <span style="color:rgba(100,100,100,1);">Drag to move objects, R to reset sim<br>
    Double click to create new objects, S to save<br>
    Right click to remove objects</span>
      <h2>What is this?</h2>
      <p>This is a simulation of three-body problem with a plot.</p>
      <ul>
        <li>Each point here corresponds to a point object with mass <code>m2</code></li>
        <li>The pixel is colored depending on which "big" object it collides with.</li>
        <li>For this, each "big" object has mass <code>m1</code> and a radius <code>r1</code></li>
        <li>Big objects have gravity</li>
        <li>But big objects do not move, they only exert forces on the small object</li>
        <li>A small object does not affect other small objects.</li>
      </ul>
      <h2>Parameters</h2>
      <ul>
        <li>
          <code>m1</code>:
          <input type="text" id="m1Input" placeholder="10">
          <p class="subtle">Mass of each big object.</p>
        </li>
        <li>
          <code>r1</code>:
          <input type="text" id="r1Input" placeholder="30">
          <p class="subtle">Radius of each big object (in pixels).</p>
        </li>
        <li>
          <code>m2</code>:
          <input type="text" id="m2Input" placeholder="1">
          <p class="subtle">Mass of each small object (pixel).</p>
        </li>
        <li>
          <code>G</code>:
          <input type="text" id="GInput" placeholder="0.6">
          <p class="subtle">Gravitational constant (big G).</p>
        </li>
        <li>
          <code>Drag</code>:
          <input type="text" id="DragInput" placeholder="1">
          <p class="subtle">Drag factor applied each timestep (1 = no drag).</p>
        </li>
        <li>
          <code>dT</code>:
          <input type="text" id="dTInput" placeholder="10">
          <p class="subtle">Time step for the simulation. Increase for speed , decrease for accuracy.<br>
          Too much dT creates ripple artifacts. The time taken to converge decreases linearly when this increases.<br>
          Recommended is 10 normally, 20 for faster simulations and 1-5 for accuracy.</p>

        </li>
        <li>
          <code>canvasSize</code>:
          <input type="text" id="canvasSizeInput" placeholder="300">
          <p class="subtle">Size of the canvas in pixels (canvas is square). <strong>The time taken increases cubicly with this parameter.</strong></p>
        </li>
      </ul>
      <button onclick="updateParameters()">Update parameters (will reload)</button>
    </div>

    <script src="sketch.js"></script>
    <script>
      function updateParameters() {
        const m1 = document.getElementById('m1Input').value || '10';
        const r1 = document.getElementById('r1Input').value || '30';
        const m2 = document.getElementById('m2Input').value || '1';
        const G = document.getElementById('GInput').value || '0.6';
        const Drag = document.getElementById('DragInput').value || '1';
        const dT = document.getElementById('dTInput').value || '10';
        const canvasSize = document.getElementById('canvasSizeInput').value || '300';
        const url = new URL(window.location.href);
        url.searchParams.set('m1', m1);
        url.searchParams.set('r1', r1);
        url.searchParams.set('m2', m2);
        url.searchParams.set('G', G);
        url.searchParams.set('Drag', Drag);
        url.searchParams.set('dT', dT);
        url.searchParams.set('canvasSize', canvasSize);
        window.location.href = url.toString();
      }
      
      window.addEventListener('load', () => {
        const params = new URL(window.location.href).searchParams;
        if (params.has('m1')) document.getElementById('m1Input').value = params.get('m1');
        if (params.has('r1')) document.getElementById('r1Input').value = params.get('r1');
        if (params.has('m2')) document.getElementById('m2Input').value = params.get('m2');
        if (params.has('G')) document.getElementById('GInput').value = params.get('G');
        if (params.has('Drag')) document.getElementById('DragInput').value = params.get('Drag');
        if (params.has('dT')) document.getElementById('dTInput').value = params.get('dT');
        if (params.has('canvasSize')) document.getElementById('canvasSizeInput').value = params.get('canvasSize');
      
      });
    </script>
  </body>
</html>
